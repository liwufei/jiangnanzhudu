import{r as f,o as t,c as o,F as x,m as y,t as a,a2 as L,B as Y,u as Z,y as N,d as ee,G as se,e as u,f as te,a as n,g as e,i as c,j as S,k as r,n as j,l as I,a3 as oe,w as ne,h as le,p as ae,C as ie,L as ce,q as re,E as q,v as de,x as _e}from"./index.193ff21d.js";import{w as ue,a as pe,b as U}from"./chat.b31cc7ff.js";import{u as fe}from"./upload.b10ece16.js";import{s as he}from"./store.83cfdc9e.js";import{u as me,_ as ge}from"./user.4d579c29.js";import{a as ve,l as be}from"./order.54656e97.js";import{_ as xe}from"./home.5fee7488.js";import{a as ye}from"./blocks.a7684095.js";const we={class:"uni-flow l-h20"},ke={emits:["click"],setup(m,{emit:g}){const z=f(["\u{1F603}","\u{1F604}","\u{1F601}","\u{1F62D}","\u{1F606}","\u{1F605}","\u{1F923}","\u{1F602}","\u{1F637}","\u{1F61B}","\u{1F642}","\u{1F643}","\u{1F609}","\u{1F60A}","\u{1F607}","\u{1F970}","\u{1F60D}","\u{1F929}","\u{1F618}","\u{1F617}","\u{1F61A}","\u{1F911}","\u{1F974}","\u{1F635}"]),v=d=>{g("click",d.target)};return(d,w)=>(t(),o("div",we,[(t(!0),o(x,null,y(z.value,i=>(t(),o("span",{onClick:v,class:"mb5 ml5 inline-block pointer"},a(i),1))),256))]))}};const V=m=>(de("data-v-4d5c3390"),m=m(),_e(),m),Ce={class:"main"},Le={class:"w chatbox"},Ie={class:"hd pl10 ml5 vertical-middle"},Se={class:"uni-flex uni-column bgf item pointer"},ze=["onClick"],Te={class:"uni-flex uni-row flex-middle"},Me={class:"portrait"},Re={class:"uni-flex uni-column pt5 pb5 ml10 f-13 width-surplus"},Ve={class:"uni-flex uni-row flex-middle width-between"},$e={class:"bold line-clamp-1 name"},Ee={class:"f-10 f-gray"},Oe={key:0,class:"f-gray f-10 mt5"},Be={key:1,class:"f-gray line-clamp-1 f-10 mt5"},He={key:0,class:"absolute f-white f-10"},Ne={key:0,class:"unread"},je={key:1,class:"unread"},qe=["onClick"],Ue={class:"uni-flex uni-row flex-middle"},De={class:"portrait"},Fe={class:"uni-flex uni-column pt5 pb5 ml10 f-13 width-surplus"},Ke={class:"uni-flex uni-row flex-middle width-between"},Ge={class:"bold line-clamp-1 name"},Je={class:"f-10 f-gray"},Ae={key:0,class:"f-gray f-10 mt5"},Pe={key:1,class:"f-gray line-clamp-1 f-10 mt5"},Qe={key:0,class:"absolute f-white f-10"},We={key:0,class:"unread"},Xe={key:1,class:"unread"},Ye={class:"uni-flex uni-row hd ml10 flex-middle"},Ze={key:0,class:"iconfont icon-shangjialiebiaoicon mr5"},es={class:"bold"},ss={class:"bd ml10"},ts={class:"uni-flex uni-column pd10 mt10"},os={key:0,class:"uni-flex uni-row mb10 flex-end"},ns={class:"mr10 text-right"},ls={class:"f-gray f-12"},as=["innerHTML"],is={class:"portrait"},cs={key:1,class:"uni-flex uni-row mb10"},rs={class:"portrait"},ds={class:"ml10"},_s={class:"flex-middle"},us={class:"ml10 f-gray f-12"},ps=["innerHTML"],fs={class:"fd mb20"},hs={class:"pl10 pt10 relative ml10"},ms={class:"meta absolute uni-flex uni-row flex-middle"},gs=V(()=>e("i",{class:"iconfont icon-tupian pointer f-18 f-gray"},null,-1)),vs=V(()=>e("i",{class:"iconfont icon-biaoqing pointer f-18 f-gray"},null,-1)),bs={class:"text-right ml10 mr10"},xs=S("\u53D1\u9001(Enter)"),ys={class:"pd10 mg5"},ws=V(()=>e("div",{style:{height:"26px"}},null,-1)),ks={class:"bgf round-edge mg5"},Cs={key:0,class:"uni-flex uni-row pd10"},Ls=["src"],Is={class:"ml10 f-13"},Ss={class:"flex-middle"},zs={class:"mr5"},Ts=["src"],Ms=S("\u8FDB\u5165\u5E97\u94FA"),Rs={class:"orders pd10"},Vs={class:"hd bold pb10"},$s={class:"bd"},Es={class:"f-12 f-gray mb5"},Os={class:"uni-flex uni-row"},Bs=["src"],Hs={class:"f-12 ml5"},Ns=["title"],js={class:"f-red mt5 mb5"},qs={setup(m){const g=f(L),{proxy:z}=Y(),v=f(!1),d=Z(),w=f({}),i=N({touser:"",list:[],logs:[]}),h=N({content:""}),_=f({}),b=f({}),$=f(null);ee(()=>{w.value=JSON.parse(localStorage.getItem("visitor"))||{},O(),$.value=setInterval(()=>{K(),O()},2e3),d.params.store_id>0?he(d.params,l=>{_.value=l,i.touser=l.store_name,ve({store_id:l.store_id,queryitem:!0},p=>{b.value=p.list},v)}):me({userid:d.params.id},l=>{i.touser=l.nickname||l.username,be({buyer_name:l.username,queryitem:!0},p=>{b.value=p.list},v)})}),se(()=>{clearInterval($.value)});const E=()=>{d.params.id?h.content.replace(/<[^>]+>/g,"").replace(/\s*/g,"")==""?q.error("\u5185\u5BB9\u4E0D\u80FD\u4E3A\u7A7A"):U(Object.assign(h,{toid:d.params.id,store_id:parseInt(d.params.store_id)}),l=>{h.content=""}):q.error("\u8BF7\u9009\u62E9\u4F1A\u8BDD\u7528\u6237")},D=l=>{fe(l.raw,{folder:"webim/"},p=>{let T='<img width="100" src="'+p.fileUrl+'" />';U({content:T,toid:d.params.id,store_id:parseInt(d.params.store_id)},B=>{})})},F=l=>{h.content+=l.innerHTML};function K(){ue({limit:50},l=>{i.list=l})}function O(){pe({toid:d.params.id,page_size:100},l=>{l.list.length>0&&(i.logs.length==0||i.logs.length>0&&l.list[l.list.length-1].id>i.logs[i.logs.length-1].id)&&(i.logs=l.list,z.$nextTick(()=>{setTimeout(()=>{g.value&&g.value.setScrollTop(1e7)},1e3)}))})}return(l,p)=>{const T=u("ChatRound"),B=u("el-icon"),k=u("el-avatar"),M=u("el-col"),G=u("el-upload"),J=u("el-popover"),A=u("el-input"),P=u("el-button"),H=u("el-tag"),Q=u("router-link"),W=u("el-row"),X=te("loading");return t(),o("div",Ce,[n(xe,{exclude:["category","searchbox","imagead"]}),e("div",Le,[n(W,{class:"round-edge wraper"},{default:c(()=>[n(M,{span:5,class:"panel"},{default:c(()=>[e("div",Ie,[n(B,{size:18,class:"mr5"},{default:c(()=>[n(T)]),_:1}),S("\u804A\u5929\u5217\u8868("+a(r(i).list.length)+") ",1)]),n(r(L),{height:"550px"},{default:c(()=>[(t(!0),o(x,null,y(r(i).list,s=>(t(),o("div",Se,[w.value.userid==s.store_id?(t(),o("div",{key:0,onClick:R=>r(j)("/webim/chat/"+s.to.userid),class:"uni-flex uni-row pd10 flex-middle width-between relative"},[e("div",Te,[e("div",Me,[n(k,{src:s.to.portrait,size:40},null,8,["src"])]),e("div",Re,[e("p",Ve,[e("span",$e,a(s.to.nickname||s.to.username),1),e("label",Ee,a(s.created),1)]),s.content.indexOf("<img")>-1?(t(),o("span",Oe,"[\u56FE\u7247]")):(t(),o("span",Be,a(s.content.replace(/<[^>]+>/g,"")),1))])]),s.unreads>0?(t(),o("div",He,[s.unreads>10?(t(),o("span",Ne,"10+")):(t(),o("span",je,a(s.unreads),1))])):I("",!0)],8,ze)):(t(),o("div",{key:1,onClick:R=>r(j)("/webim/chat/"+s.to.userid+"/"+parseInt(s.store_id)),class:"uni-flex uni-row pd10 flex-middle width-between relative"},[e("div",Ue,[e("div",De,[n(k,{src:s.to.portrait,size:40},null,8,["src"])]),e("div",Fe,[e("p",Ke,[e("span",Ge,a(s.store_name||s.to.nickname||s.to.username),1),e("label",Je,a(s.created),1)]),s.content.indexOf("<img")>-1?(t(),o("span",Ae,"[\u56FE\u7247]")):(t(),o("span",Pe,a(s.content.replace(/<[^>]+>/g,"")),1))])]),s.unreads>0?(t(),o("div",Qe,[s.unreads>10?(t(),o("span",We,"10+")):(t(),o("span",Xe,a(s.unreads),1))])):I("",!0)],8,qe))]))),256))]),_:1})]),_:1}),n(M,{span:13,class:"gallery"},{default:c(()=>[e("div",Ye,[_.value.store_id?(t(),o("i",Ze)):I("",!0),e("p",es,a(_.value.store_id?r(i).touser:"\u4E0E\u201C"+r(i).touser+"\u201D\u4F1A\u8BDD\u4E2D"),1)]),e("div",ss,[n(r(L),{ref_key:"scrollbarRef",ref:g,height:"400px"},{default:c(()=>[(t(!0),o(x,null,y(r(i).logs,s=>(t(),o("div",ts,[s.fromid==w.value.userid?(t(),o("div",os,[e("div",ns,[e("div",null,[e("span",ls,a(s.created),1)]),e("div",{class:"detail-info pd10 mb10 bgp round-edge inline-block",innerHTML:s.content},null,8,as)]),e("div",is,[n(k,{src:s.from.portrait,size:40},null,8,["src"])])])):(t(),o("div",cs,[e("div",rs,[n(k,{src:s.from.portrait,size:40},null,8,["src"])]),e("div",ds,[e("div",_s,[e("span",null,a(s.from.nickname||s.from.username),1),e("span",us,a(s.created),1)]),e("div",{class:"detail-info pd10 mb10 bgf round-edge inline-block",innerHTML:s.content},null,8,ps)])]))]))),256))]),_:1},512)]),e("div",fs,[e("div",hs,[e("div",ms,[n(G,{action:"#","show-file-list":!1,"auto-upload":!1,"on-change":D,class:"mr10"},{default:c(()=>[gs]),_:1}),n(J,{placement:"top-start",width:200,trigger:"click"},{reference:c(()=>[vs]),default:c(()=>[n(ke,{onClick:F})]),_:1})]),n(A,{modelValue:r(h).content,"onUpdate:modelValue":p[0]||(p[0]=s=>r(h).content=s),type:"textarea",class:"textarea",placeholder:"\u8BF7\u8F93\u5165\u6D88\u606F\uFF0C\u6309\u53D1\u9001\u952E\u53D1\u9001",resize:"none",onKeyup:oe(E,["enter","native"])},null,8,["modelValue","onKeyup"])]),e("div",bs,[n(P,{onClick:E,class:"send",type:"primary"},{default:c(()=>[xs]),_:1})])])]),_:1}),n(M,{span:6},{default:c(()=>[e("div",ys,[ws,ne((t(),o("div",ks,[_.value.store_id?(t(),o("div",Cs,[e("p",null,[e("img",{src:_.value.store_logo,width:"44"},null,8,Ls)]),e("p",Is,[e("span",Ss,[e("label",zs,a(_.value.store_name),1),e("img",{src:_.value.credit_image,width:"13"},null,8,Ts)]),n(Q,{to:"/store/index/"+_.value.store_id,class:"rlink block mt5 f-12"},{default:c(()=>[n(H,null,{default:c(()=>[Ms]),_:1})]),_:1},8,["to"])])])):I("",!0),b.value.length>0?(t(),le(r(L),{key:1,height:_.value.store_id?"456px":"524px"},{default:c(()=>[e("div",Rs,[e("div",Vs,a(_.value.store_id?"\u6211\u7684\u8BA2\u5355":"\u5DF2\u4E0B\u5355"),1),e("div",$s,[(t(!0),o(x,null,y(b.value,(s,R)=>(t(),o("div",{class:ae(["item round-edge bgp pl10 pt5 pr10 pb5",R==b.value.length-1?"":"mb10"])},[e("p",Es,"\u8BA2\u5355\u53F7\uFF1A"+a(s.order_sn),1),(t(!0),o(x,null,y(s.items,C=>(t(),o("div",Os,[e("p",null,[e("img",{class:"round-edge",src:C.goods_image,width:"66"},null,8,Bs)]),e("div",Hs,[e("p",{class:"line-clamp-1",title:C.goods_name},a(C.goods_name),9,Ns),e("p",js,a(r(ie)(C.price)),1),n(H,{type:"warning"},{default:c(()=>[S(a(r(ce)(s.status)),1)]),_:2},1024)])]))),256))],2))),256))])])]),_:1},8,["height"])):(t(),o("div",{key:2,class:"flex-middle flex-center f-gray",style:re(_.value.store_id?"height:456px":"height:524px")},"\u6682\u65E0\u8BA2\u5355/\u5546\u54C1\u4FE1\u606F",4))])),[[X,v.value]])])]),_:1})]),_:1})]),n(ge)])}}};var Qs=ye(qs,[["__scopeId","data-v-4d5c3390"]]);export{Qs as default};
