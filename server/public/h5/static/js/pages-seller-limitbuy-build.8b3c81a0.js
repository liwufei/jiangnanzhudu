(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-seller-limitbuy-build"],{"22ed":function(t,i,e){"use strict";e("6a54");var s=e("f5bd").default;Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=s(e("ac89")),u=s(e("de97")),n={data:function(){return{id:0,goods:{},goods_id:0,gallery:{list:[]},limitbuy:{title:"卖家促销",start_time:"",end_time:""}}},methods:{submit:function(){u.default.submit(this)},clearInput:function(t,i){this.limitbuy[i]=""},redirect:function(t){uni.setStorageSync("limitbuy",this.limitbuy),a.default.redirect(t+"?redirect="+this.$mp.page.route,"navigate")}},onLoad:function(t){if(this.id=t.id||0,this.goods_id=t.goods_id||0,a.default.verifyLogin(!0,this.$mp.page.route)){if(!a.default.verifySeller())return a.default.redirect("/pages/seller/store/apply");this.id?u.default.limitbuy(this):u.default.goods(this)}}};i.default=n},"250b":function(t,i,e){"use strict";e.d(i,"b",(function(){return a})),e.d(i,"c",(function(){return u})),e.d(i,"a",(function(){return s}));var s={uniIcons:e("ea5d").default,uniDatetimePicker:e("7794").default},a=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("v-uni-view",[e("v-uni-view",{staticClass:"uni-flex uni-column bgf round-edge ml10 mr10 mt10 pt5 pr10 pb5 pl10"},[e("v-uni-view",{staticClass:"uni-flex uni-row pt10 pb10 flex-middle f-16"},[e("v-uni-text",{staticClass:"mr10"},[t._v("活动名称")]),e("v-uni-input",{staticClass:"width-surplus",attrs:{placeholder:"设置活动标题"},model:{value:t.limitbuy.title,callback:function(i){t.$set(t.limitbuy,"title",i)},expression:"limitbuy.title"}}),e("uni-icons",{directives:[{name:"show",rawName:"v-show",value:t.limitbuy.title,expression:"limitbuy.title"}],staticClass:"ml10",attrs:{type:"closeempty",color:"gray"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.clearInput(i,"title")}}})],1),e("v-uni-view",{staticClass:"uni-flex uni-row pt10 pb10 flex-middle f-16 bt"},[e("v-uni-text",{staticClass:"mr10"},[t._v("开始时间")]),e("uni-datetime-picker",{staticClass:"width-surplus",attrs:{border:!1,type:"datetime"},model:{value:t.limitbuy.start_time,callback:function(i){t.$set(t.limitbuy,"start_time",i)},expression:"limitbuy.start_time"}},[e("v-uni-text",{staticClass:"f-16 f-gray"},[t._v(t._s(t.limitbuy.start_time||"设置开始时间"))])],1)],1),e("v-uni-view",{staticClass:"uni-flex uni-row pt10 pb10 flex-middle f-16 bt"},[e("v-uni-text",{staticClass:"mr10"},[t._v("结束时间")]),e("uni-datetime-picker",{staticClass:"width-surplus",attrs:{border:!1,type:"datetime"},model:{value:t.limitbuy.end_time,callback:function(i){t.$set(t.limitbuy,"end_time",i)},expression:"limitbuy.end_time"}},[e("v-uni-text",{staticClass:"f-16 f-gray"},[t._v(t._s(t.limitbuy.end_time||"设置结束时间"))])],1)],1)],1),e("v-uni-view",{staticClass:"uni-flex uni-column bgf round-edge ml10 mr10 mt10 pt5 pr10 pb5 pl10"},[e("v-uni-view",{staticClass:"uni-flex uni-row pt10 pb10 flex-middle width-between f-16"},[e("v-uni-text",{staticClass:"mr10"},[t._v("抢购商品")]),e("v-uni-view",{staticClass:"f-16 f-red",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.redirect("/pages/popup/goods")}}},[t.goods.goods_id?e("v-uni-text",[t._v("更换")]):e("v-uni-text",[t._v("添加")])],1)],1),t.gallery.list.length>0?e("v-uni-view",{staticClass:"gallery"},t._l(t.gallery.list,(function(i,s){return e("v-uni-view",{key:s,staticClass:"uni-flex uni-row bt pt10"},[e("v-uni-view",{staticClass:"image"},[e("v-uni-image",{attrs:{src:i.image||t.goods.default_image,mode:"widthFix"}})],1),e("v-uni-view",{staticClass:"uni-flex uni-column ml10"},[e("v-uni-text",{staticClass:"line-clamp-2 l-h20"},[t._v(t._s(t.goods.goods_name))]),e("v-uni-text",{staticClass:"f-gray"},[t._v(t._s(i.specification))]),e("v-uni-view",{staticClass:"uni-flex uni-row mt5 flex-middle"},[e("v-uni-text",{staticClass:"uni-bold f-15"},[t._v(t._s(t._f("currency")(i.price)))]),e("v-uni-text",{staticClass:"f-gray ml10"},[t._v("库存"+t._s(i.stock||0)+"件")])],1),e("v-uni-view",{staticClass:"uni-flex uni-row width-between pt10 flex-middle mt10"},[e("v-uni-text",{staticClass:"width-surplus f-gray"},[t._v("折扣")]),e("v-uni-view",{staticClass:"uni-flex uni-row flex-middle flex-end"},[e("v-uni-input",{staticClass:"mr5 f-12 uni-center",attrs:{type:"digit",maxlength:"4",placeholder:"0.01-9.99"},model:{value:i.discount,callback:function(e){t.$set(i,"discount",e)},expression:"item.discount"}}),e("v-uni-text",[t._v("折")])],1)],1),e("v-uni-view",{staticClass:"uni-flex uni-row width-between pb10 flex-middle mt5"},[e("v-uni-text",{staticClass:"width-surplus f-gray width-surplus"},[t._v("减价")]),e("v-uni-view",{staticClass:"uni-flex uni-row flex-middle flex-end"},[e("v-uni-input",{staticClass:"mr5 f-12 uni-center",attrs:{type:"digit",placeholder:"输入金额"},model:{value:i.decrease,callback:function(e){t.$set(i,"decrease",e)},expression:"item.decrease"}}),e("v-uni-text",[t._v("元")])],1)],1)],1)],1)})),1):t._e()],1),e("v-uni-view",{staticClass:"pd10"},[e("v-uni-view",{staticClass:"mybutton f-white f-16 mt10",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.submit.apply(void 0,arguments)}}},[t._v("保存提交")])],1)],1)},u=[]},"29da":function(t,i,e){"use strict";e.r(i);var s=e("250b"),a=e("a97b");for(var u in a)["default"].indexOf(u)<0&&function(t){e.d(i,t,(function(){return a[t]}))}(u);e("9a83");var n=e("828b"),l=Object(n["a"])(a["default"],s["b"],s["c"],!1,null,"0cf51b40",null,!1,s["a"],void 0);i["default"]=l.exports},"5cb1":function(t,i,e){var s=e("aa6e");s.__esModule&&(s=s.default),"string"===typeof s&&(s=[[t.i,s,""]]),s.locals&&(t.exports=s.locals);var a=e("967d").default;a("65347a1c",s,!0,{sourceMap:!1,shadowMode:!1})},"9a83":function(t,i,e){"use strict";var s=e("5cb1"),a=e.n(s);a.a},a97b:function(t,i,e){"use strict";e.r(i);var s=e("22ed"),a=e.n(s);for(var u in s)["default"].indexOf(u)<0&&function(t){e.d(i,t,(function(){return s[t]}))}(u);i["default"]=a.a},aa6e:function(t,i,e){var s=e("c86c");i=s(!1),i.push([t.i,".mybutton[data-v-0cf51b40]{border-radius:%?20?%}.gallery .image[data-v-0cf51b40],\n.gallery uni-image[data-v-0cf51b40]{width:%?150?%;height:%?150?%;border-radius:%?10?%}.gallery uni-input[data-v-0cf51b40]{width:%?140?%;padding:%?8?% 0;background-color:#f5f5f5;border-radius:%?10?%}",""]),t.exports=i},de97:function(t,i,e){"use strict";var s=e("f5bd").default;e("64aa");var a=s(e("0ed1")),u=s(e("ac89"));function n(t){var i=[];a.default.request("goods/read",{goods_id:t.goods_id},(function(e){0==e.code&&e.data&&(t.goods=e.data,function(t){var i=uni.getStorageSync("limitbuy");i&&(t.limitbuy.title=i.title,t.limitbuy.start_time=i.start_time,t.limitbuy.end_time=i.end_time,uni.removeStorageSync("limitbuy"))}(t),a.default.request("goods/specs",{goods_id:t.goods_id},(function(e){if(0==e.code){for(var s in e.data.list){var a=e.data.list[s];i[s]={specification:a.spec_1+" "+a.spec_2,price:a.price,stock:a.stock,image:a.image,spec_id:a.spec_id};var n=t.limitbuy.rules;u.default.isEmpty(n)||u.default.isEmpty(n[a.spec_id])||("discount"==n[a.spec_id].pro_type?i[s]["discount"]=n[a.spec_id].price:i[s]["decrease"]=n[a.spec_id].price)}t.gallery.list=i}})))}))}t.exports={limitbuy:
/**
 * @link https://www.shopwind.net/
 * @copyright Copyright (c) 2018 ShopWind Inc. All Rights Reserved.
 *
 * This is not free software. Do not use it for commercial purposes. 
 * If you need commercial operation, please contact us to purchase a license.
 * @license https://www.shopwind.net/license/
 *
 * @Id build.js 2020.2.1 $
 * @author mosir
 */
function(t){a.default.request("limitbuy/read",{id:t.id,queryrules:!0},(function(i){0==i.code&&(t.limitbuy=i.data||{},n(t))}))},goods:n,submit:function(t){if(t.gallery.list.length<1)return uni.showModal({content:"请选择商品",showCancel:!1}),!1;var i={};for(var e in t.gallery.list){var s=t.gallery.list[e];if(i[s.spec_id]={},s.discount&&Number(s.discount)>0&&Number(s.discount)<10)i[s.spec_id].discount=Number(s.discount);else{if(!(s.decrease&&Number(s.decrease)>0&&Number(s.decrease)<Number(s.price)))return uni.showModal({title:"提示",content:"优惠设置不合理，请检查！",showCancel:!1}),!1;i[s.spec_id].price=Number(s.decrease)}}a.default.request(t.id?"limitbuy/update":"limitbuy/add",Object.assign(t.limitbuy,{rules:i,goods_id:t.goods_id}),(function(i){0==i.code?uni.showToast({title:t.id?"修改成功":"创建成功",duration:2e3,success:function(){setTimeout((function(){u.default.redirect("/pages/seller/limitbuy/list")}),2e3)}}):i.message&&uni.showToast({title:i.message,icon:"none"})}))}}}}]);