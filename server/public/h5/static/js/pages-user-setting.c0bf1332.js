(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-user-setting"],{"201c":function(i,t,e){"use strict";var n=e("f5bd").default;e("bf0f"),e("2797"),e("de6c");var s=n(e("2634")),a=n(e("2fdc")),o=n(e("39d8")),u=n(e("0ed1")),c=n(e("ac89"));n(e("62a0"));function l(){return l=(0,a.default)((0,s.default)().mark((function i(t,e){return(0,s.default)().wrap((function(i){while(1)switch(i.prev=i.next){case 0:uni.chooseImage({count:1,sizeType:["compressed"],success:function(i){u.default.upload("upload/file",i.tempFilePaths[0],{folder:"profile/"+t.visitor.userid+"/",filename:e},(function(i){0==i.code?(t.visitor[e]=i.data.fileUrl,u.default.request("user/update",(0,o.default)({},e,i.data.fileUrl),(function(i){0==i.code?(uni.setStorageSync("visitor",t.visitor),uni.showToast({title:"上传成功"})):uni.showToast({title:i.message,icon:"none"})}))):uni.showToast({title:i.message,icon:"none"})}))},fail:function(i){uni.showModal({content:i.errMsg,showCancel:!1})}});case 1:case"end":return i.stop()}}),i)}))),l.apply(this,arguments)}i.exports={user:
/**
 * @link https://www.shopwind.net/
 * @copyright Copyright (c) 2018 ShopWind Inc Inc. All Rights Reserved.
 *
 * This is not free software. Do not use it for commercial purposes. 
 * If you need commercial operation, please contact us to purchase a license.
 * @license https://www.shopwind.net/license/
 *
 * @Id setting.js 2019.10.29 $
 * @author winder
 */
function(i){u.default.request("user/read",null,(function(t){0==t.code&&(i.visitor=uni.getStorageSync("visitor")||{},Object.assign(i.visitor,t.data),uni.setStorageSync("visitor",i.visitor))}))},logout:function(i){uni.showModal({title:"提示",content:"确定退出登录？",success:function(i){i.confirm&&(uni.removeStorageSync("visitor"),uni.removeStorageSync("access_token"),uni.navigateTo({url:"/pages/user/login"}))}})},logoff:function(i){uni.showModal({title:"提示",content:"注销后，该账户将永久删除，您要继续吗？",success:function(i){i.confirm&&u.default.request("user/logoff",null,(function(i){0==i.code&&(uni.removeStorageSync("visitor"),uni.removeStorageSync("access_token"),uni.switchTab({url:"/pages/index/index"}))}))}})},profile:function(i,t,e){u.default.request("user/update",(0,o.default)({},t,e),(function(n){0==n.code?uni.showToast({title:"修改成功",complete:function(){i.visitor[t]=e}}):uni.showToast({title:n.message,icon:"none"})}))},upload:function(i,t){return l.apply(this,arguments)},cache:function(i){uni.getStorageInfo({success:function(i){i.keys.forEach((function(i){"visitor"!=i&&"access_token"!=i&&uni.removeStorageSync(i)})),uni.showToast({title:"缓存已清除"})}})},connect:function(i,t,e){if("remove"==e)uni.showActionSheet({itemList:["解除绑定"],success:function(n){0==n.tapIndex&&uni.showModal({title:"提示",content:"解除绑定后，关联账号将无法登录，确定吗？",success:function(n){n.confirm&&function(i,t,e){u.default.request("remove"==e?"user/unbind":"user/bind",t,(function(n){if(0==n.code&&n.data){if(i.visitor.thirds=n.data||{},"remove"!=e){var s=uni.getStorageSync("visitor")||{};uni.setStorageSync("visitor",Object.assign(s,{openid:"APP"==t.terminal?n.data.weixinapp:n.data.weixinmp}))}uni.showToast({title:"remove"==e?"您已解除绑定":"绑定成功！",duration:2e3}),i.$forceUpdate()}else n.message&&uni.showModal({content:n.message,showCancel:!1})}))}(i,t,e)}})}});else{if(c.default.isWechat()){if("alipay"==t.logintype)return void uni.showToast({title:"请在支付宝客户端打开链接",icon:"none"})}else{if("weixin"==t.logintype)return void uni.showToast({title:"请在微信客户端打开链接",icon:"none"});if("alipay"==t.logintype&&!c.default.isAlipay())return void uni.showToast({title:"请在支付宝客户端打开链接",icon:"none"})}u.default.request("auth/connect",Object.assign(t,{callback:c.default.siteUrl()+"/pages/login/callback"}),(function(i){0==i.code&&i.data&&(uni.setStorageSync("redirect",c.default.getUrl()),location.href=i.data.redirect)}))}}}},4972:function(i,t,e){"use strict";e("6a54");var n=e("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=n(e("ac89")),a=n(e("201c")),o={data:function(){return{util:s.default,visitor:{thirds:{}},genders:["女","男","保密"]}},methods:{upload:function(i){a.default.upload(this,i)},gender:function(){var i=this;uni.showActionSheet({itemList:i.genders,success:function(t){a.default.profile(i,"gender",2-t.tapIndex)}})},connect:function(i,t){a.default.connect(this,{logintype:i},t)},logout:function(){a.default.logout(this)},logoff:function(){a.default.logoff(this)},cache:function(){a.default.cache(this)}},onLoad:function(i){s.default.verifyLogin(!0,this.$mp.page.route)&&a.default.user(this)}};t.default=o},5449:function(i,t,e){"use strict";e.r(t);var n=e("59ad"),s=e("ab6d");for(var a in s)["default"].indexOf(a)<0&&function(i){e.d(t,i,(function(){return s[i]}))}(a);e("c454");var o=e("828b"),u=Object(o["a"])(s["default"],n["b"],n["c"],!1,null,"4304f8bd",null,!1,n["a"],void 0);t["default"]=u.exports},"59ad":function(i,t,e){"use strict";e.d(t,"b",(function(){return s})),e.d(t,"c",(function(){return a})),e.d(t,"a",(function(){return n}));var n={uniIcons:e("ea5d").default},s=function(){var i=this,t=i.$createElement,n=i._self._c||t;return n("v-uni-view",{staticClass:"bgp"},[n("v-uni-view",{staticClass:"round-edge ml10 mr10 bgf mt10"},[n("v-uni-view",{staticClass:"uni-flex uni-row pd10 width-between flex-middle"},[n("v-uni-view",{staticClass:"uni-flex uni-row width-surplus portait",on:{click:function(t){arguments[0]=t=i.$handleEvent(t),i.upload("portrait")}}},[i.visitor.portrait?n("v-uni-image",{attrs:{src:i.visitor.portrait,mode:"scaleToFill"}}):n("v-uni-image",{attrs:{src:e("a709"),mode:"scaleToFill"}}),n("v-uni-view",{staticClass:"uni-flex uni-column f-gray ml10 mt5 f-14"},[n("v-uni-view",[i._v("点此设置用户头像")]),n("v-uni-text",[i._v("用户名："+i._s(i.visitor.username))])],1)],1),n("uni-icons",{attrs:{type:"arrowright"}})],1),n("v-uni-navigator",{staticClass:"uni-flex width-between pd10 bt f-15",attrs:{url:"/pages/user/profile?field=nickname","hover-class":"none"}},[n("v-uni-text",[i._v("用户昵称")]),n("v-uni-view",{staticClass:"uni-flex uni-row"},[n("v-uni-view",{staticClass:"f-15"},[i._v(i._s(i.visitor.nickname))]),n("uni-icons",{attrs:{type:"arrowright"}})],1)],1),n("v-uni-navigator",{staticClass:"uni-flex width-between pd10 bt f-15",attrs:{url:"/pages/user/profile?field=password","hover-class":"none"}},[n("v-uni-text",[i._v("修改密码")]),n("uni-icons",{attrs:{type:"arrowright"}})],1),n("v-uni-navigator",{staticClass:"uni-flex width-between pd10 bt f-15",attrs:{url:"/pages/my/address/list","hover-class":"none"}},[n("v-uni-text",[i._v("收货地址")]),n("v-uni-view",{staticClass:"uni-flex uni-row"},[n("v-uni-view",{staticClass:"f-15"}),n("uni-icons",{attrs:{type:"arrowright"}})],1)],1)],1),n("v-uni-view",{staticClass:"pd10 uni-bold f-15"},[i._v("关联账号")]),n("v-uni-view",{staticClass:"round-edge ml10 mr10 bgf"},[n("v-uni-view",{staticClass:"uni-flex width-between  pd10 flex-middle"},[n("v-uni-view",{staticClass:"uni-flex uni-row flex-middle f-15"},[n("uni-icons",{staticClass:"l-h20",attrs:{type:"weixin",color:"#04BE02",size:"40"}}),n("v-uni-text",{staticClass:"ml10"},[i._v("微信")])],1),n("v-uni-view",{staticClass:"uni-flex uni-row f-15 vertical-middle"},[Object.keys(i.visitor.thirds||[]).join("").includes("weixin")?n("uni-icons",{attrs:{type:"checkbox-filled",color:"#00cc00",size:"36"},on:{click:function(t){arguments[0]=t=i.$handleEvent(t),i.connect("weixin","remove")}}}):n("v-uni-text",{staticClass:"f-c60",on:{click:function(t){arguments[0]=t=i.$handleEvent(t),i.connect("weixin")}}},[i._v("未绑定")])],1)],1),n("v-uni-view",{staticClass:"uni-flex width-between pd10 flex-middle bt"},[n("v-uni-view",{staticClass:"uni-flex uni-row flex-middle f-15"},[n("uni-icons",{staticClass:"l-h20",attrs:{type:"qq",color:"#24c9fd",size:"40"}}),n("v-uni-text",{staticClass:"ml10"},[i._v("QQ")])],1),n("v-uni-view",{staticClass:"uni-flex uni-row f-15 vertical-middle"},[Object.keys(i.visitor.thirds||[]).join("").includes("qq")?n("uni-icons",{attrs:{type:"checkbox-filled",color:"#00cc00",size:"36"},on:{click:function(t){arguments[0]=t=i.$handleEvent(t),i.connect("qq","remove")}}}):n("v-uni-text",{staticClass:"f-c60",on:{click:function(t){arguments[0]=t=i.$handleEvent(t),i.connect("qq")}}},[i._v("未绑定")])],1)],1),n("v-uni-view",{staticClass:"uni-flex width-between pd10 flex-middle bt"},[n("v-uni-view",{staticClass:"uni-flex uni-row flex-middle f-15"},[n("v-uni-text",{staticClass:"iconfont alipay"}),n("v-uni-text",{staticClass:"ml10"},[i._v("支付宝")])],1),n("v-uni-view",{staticClass:"uni-flex uni-row f-15 vertical-middle"},[Object.keys(i.visitor.thirds||[]).join("").includes("alipay")?n("uni-icons",{attrs:{type:"checkbox-filled",color:"#00cc00",size:"36"},on:{click:function(t){arguments[0]=t=i.$handleEvent(t),i.connect("alipay","remove")}}}):n("v-uni-text",{staticClass:"f-c60",on:{click:function(t){arguments[0]=t=i.$handleEvent(t),i.connect("alipay")}}},[i._v("未绑定")])],1)],1)],1),n("v-uni-view",{staticClass:"pd10 uni-bold f-15"},[i._v("个人信息")]),n("v-uni-view",{staticClass:"round-edge ml10 mr10 bgf"},[n("v-uni-navigator",{staticClass:"uni-flex width-between pd10 bt f-15",attrs:{url:"/pages/user/phone","hover-class":"none"}},[n("v-uni-text",[i._v("手机号码")]),n("v-uni-view",{staticClass:"uni-flex uni-row"},[n("v-uni-view",{staticClass:"f-15"},[i._v(i._s(i.visitor.phone_mob))]),n("uni-icons",{attrs:{type:"arrowright"}})],1)],1),n("v-uni-navigator",{staticClass:"uni-flex width-between pd10 bt f-15",attrs:{url:"/pages/user/profile?field=email","hover-class":"none"}},[n("v-uni-text",[i._v("电子邮箱")]),n("v-uni-view",{staticClass:"uni-flex uni-row"},[n("v-uni-view",{staticClass:"f-15"},[i._v(i._s(i.visitor.email))]),n("uni-icons",{attrs:{type:"arrowright"}})],1)],1),n("v-uni-navigator",{staticClass:"uni-flex width-between pd10 bt f-15",attrs:{url:"/pages/user/profile?field=qq","hover-class":"none"}},[n("v-uni-text",[i._v("QQ号")]),n("v-uni-view",{staticClass:"uni-flex uni-row"},[n("v-uni-view",{staticClass:"f-15"},[i._v(i._s(i.visitor.qq||""))]),n("v-uni-view",{staticClass:"uni-flex uni-row"},[n("v-uni-view",{staticClass:"f-15"}),n("uni-icons",{attrs:{type:"arrowright"}})],1)],1)],1),n("v-uni-navigator",{staticClass:"uni-flex width-between pd10 bt f-15",attrs:{url:"/pages/user/profile?field=birthday","hover-class":"none"}},[n("v-uni-text",[i._v("生日")]),n("v-uni-view",{staticClass:"uni-flex uni-row"},[n("v-uni-view",{staticClass:"f-15"},[i._v(i._s(i.visitor.birthday||""))]),n("uni-icons",{attrs:{type:"arrowright"}})],1)],1),n("v-uni-view",{staticClass:"uni-flex width-between pd10 bt f-15",on:{click:function(t){arguments[0]=t=i.$handleEvent(t),i.gender.apply(void 0,arguments)}}},[n("v-uni-text",[i._v("性别")]),n("v-uni-view",{staticClass:"uni-flex uni-row"},[n("v-uni-view",{staticClass:"f-15"},[i._v(i._s(1==i.visitor.gender?"男":2==i.visitor.gender?"女":"保密"))]),n("uni-icons",{attrs:{type:"arrowright"}})],1)],1)],1),n("v-uni-view",{staticClass:"pd10 uni-bold f-15"},[i._v("辅助功能")]),n("v-uni-view",{staticClass:"round-edge ml10 mr10 bgf"},[n("v-uni-view",{staticClass:"uni-flex width-between pd10 f-15",on:{click:function(t){arguments[0]=t=i.$handleEvent(t),i.cache.apply(void 0,arguments)}}},[n("v-uni-text",[i._v("清理缓存")]),n("v-uni-view",{staticClass:"uni-flex uni-row"},[n("v-uni-view",{staticClass:"f-15"}),n("uni-icons",{attrs:{type:"arrowright"}})],1)],1),n("v-uni-navigator",{staticClass:"uni-flex width-between pd10 bt f-15",attrs:{url:"/pages/article/detail?id=6","hover-class":"none"}},[n("v-uni-text",[i._v("隐私政策")]),n("v-uni-view",{staticClass:"uni-flex uni-row"},[n("v-uni-view",{staticClass:"f-15"}),n("uni-icons",{attrs:{type:"arrowright"}})],1)],1),n("v-uni-view",{staticClass:"uni-flex width-between pd10 f-15 bt",on:{click:function(t){arguments[0]=t=i.$handleEvent(t),i.logoff.apply(void 0,arguments)}}},[n("v-uni-text",[i._v("注销账号")]),n("v-uni-view",{staticClass:"uni-flex uni-row"},[n("v-uni-view",{staticClass:"f-15"}),n("uni-icons",{attrs:{type:"arrowright"}})],1)],1),n("v-uni-navigator",{staticClass:"uni-flex width-between pd10 bt f-15",attrs:{url:"/pages/about/about","hover-class":"none"}},[n("v-uni-text",[i._v("关于我们")]),n("v-uni-view",{staticClass:"uni-flex uni-row"},[n("v-uni-view",{staticClass:"f-15"}),n("uni-icons",{attrs:{type:"arrowright"}})],1)],1)],1),n("v-uni-view",{staticClass:"pd10"},[n("v-uni-view",{staticClass:"mybutton f-white f-15 mt10",on:{click:function(t){arguments[0]=t=i.$handleEvent(t),i.logout.apply(void 0,arguments)}}},[i._v("退出当前账户")])],1)],1)},a=[]},"92c5":function(i,t,e){var n=e("d45a");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[i.i,n,""]]),n.locals&&(i.exports=n.locals);var s=e("967d").default;s("122bd41a",n,!0,{sourceMap:!1,shadowMode:!1})},a709:function(i,t,e){i.exports=e.p+"static/images/default_user_portrait.gif"},ab6d:function(i,t,e){"use strict";e.r(t);var n=e("4972"),s=e.n(n);for(var a in n)["default"].indexOf(a)<0&&function(i){e.d(t,i,(function(){return n[i]}))}(a);t["default"]=s.a},c454:function(i,t,e){"use strict";var n=e("92c5"),s=e.n(n);s.a},d45a:function(i,t,e){var n=e("c86c");t=n(!1),t.push([i.i,".portait uni-image[data-v-4304f8bd]{width:%?120?%;height:%?120?%;border-radius:50%}",""]),i.exports=t}}]);