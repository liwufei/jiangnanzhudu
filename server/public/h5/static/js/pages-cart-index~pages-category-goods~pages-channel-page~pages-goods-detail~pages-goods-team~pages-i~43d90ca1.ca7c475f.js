(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-cart-index~pages-category-goods~pages-channel-page~pages-goods-detail~pages-goods-team~pages-i~43d90ca1"],{"1c25":function(e,t,s){"use strict";s.r(t);var i=s("60b3"),n=s.n(i);for(var a in i)["default"].indexOf(a)<0&&function(e){s.d(t,e,(function(){return i[e]}))}(a);t["default"]=n.a},2496:function(e,t,s){"use strict";var i=s("f5bd").default;s("22b6"),s("bf0f"),s("2797"),s("aa9c"),s("64aa"),s("e838");var n=i(s("0ed1")),a=i(s("ac89"));
/**
 * @link https://www.shopwind.net/
 * @copyright Copyright (c) 2018 ShopWind Inc. All Rights Reserved.
 *
 * This is not free software. Do not use it for commercial purposes. 
 * If you need commercial operation, please contact us to purchase a license.
 * @license https://www.shopwind.net/license/
 *
 * @Id cart.js 2019.10.19 $
 * @author winder
 */
function o(e,t){n.default.request("cart/list",null,(function(s){0==s.code&&function(){var i={list:[],quantity:{},total:0,amount:0,weight:0},n=[];if(a.default.isEmpty(t))for(var o in s.data.list){var c=s.data.list[o];Object.values(c.items).forEach((function(e){n.push(e)}))}else n=s.data.list?s.data.list[t]:null,n=n?Object.values(n.items):[];n.forEach((function(t){i.list.push(t),a.default.isEmpty(i.quantity[t.goods_id])&&e.$set(i.quantity,t.goods_id,{specs:{},total:0}),a.default.isEmpty(i.quantity[t.goods_id].specs[t.spec_id])&&e.$set(i.quantity[t.goods_id].specs,t.spec_id,t.quantity),i.quantity[t.goods_id].total+=Number(t.quantity),i.total+=Number(t.quantity),i.weight+=Number(t.weight)*Number(t.quantity);var s=a.default.isEmpty(t.promotion)?t.price:t.promotion.price;i.amount+=parseFloat(s*Number(t.quantity))})),e.cart=i}()}))}function c(e,t,s,i,c){n.default.request("cart/add",{spec_id:t.spec_id,quantity:s},(function(t){0==t.code?(o(e,c),"function"==typeof i&&i()):4004==t.code?uni.navigateTo({url:"/pages/user/login?redirect="+encodeURIComponent(a.default.getUrl())}):t.message&&uni.showToast({title:t.message,icon:"none"})}))}e.exports={build:o,add:c,update:function(e,t,s,i,l){if(a.default.isEmpty(e.cart.quantity[t.goods_id])||a.default.isEmpty(e.cart.quantity[t.goods_id].specs[t.spec_id]))return s>0&&c(e,t,s,i,l);s+=Number(e.cart.quantity[t.goods_id].specs[t.spec_id]),s>0?n.default.request("cart/update",{spec_id:t.spec_id,quantity:s},(function(t){0==t.code?(o(e,l),"function"==typeof i&&i()):t.message&&uni.showToast({title:t.message,icon:"none"})})):n.default.request("cart/remove",{specs:[t.spec_id]},(function(t){0==t.code?o(e,l):t.message&&uni.showToast({title:t.message,icon:"none"})}))},submit:function(e,t){if(e.cart.total<=0)return uni.showToast({title:"您还没有选择商品哦",icon:"none"}),!1;if(t>0&&t>Number(e.cart.amount))return uni.showToast({title:"未满起送金额",icon:"none"}),!1;var s={};for(var i in e.cart.list){var o=e.cart.list[i];o.quantity>0&&(s[o.spec_id]=o.quantity)}n.default.request("cart/many",{specs:s,selected:1},(function(e){0==e.code?a.default.redirect("/pages/cashier/order/normal","navigate"):e.message&&uni.showModal({title:"下单失败",content:e.message,showCancel:!1})}))}}},"60b3":function(e,t,s){"use strict";s("6a54"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,s("64aa"),s("aa9c");var i={props:{size:{type:Number,default:6},endPos:{type:Object,default:function(){return{x:150,y:150}}},duration:{type:Number,default:300},zIndex:{type:Number,default:999},ballImage:{type:String,default:""},ballColor:{type:String,default:"var(--color-red)"}},data:function(){return{balls:[],xTimeFunction:["ease-in","ease-out"],yTimeFunction:["cubic-bezier(0.4,-0.2, 0.4,0.4)","cubic-bezier(0, 0.59, 0.46, 2.15)"]}},mounted:function(){this.initBalls()},methods:{drop:function(e){for(var t,s=0;s<this.balls.length;s++)this.balls[s].show||(t=this.balls[s]);t.start.x=e.x,t.start.y=e.y,t.offset.x=this.endPos.x-e.x,t.offset.y=this.endPos.y-e.y,t.offset.y>0?t.ani=1:t.ani=0,t.show=1,this.balls.push({show:0,start:{x:0,y:0},offset:{x:0,y:0},ani:0}),setTimeout((function(){t.show=0}),this.duration),function(e,t,s){return function(){var i=arguments;e.id&&clearTimeout(e.id),e.id=setTimeout((function(){e.apply(s,i)}),t)}}(this.initBalls,this.duration+200,this)()},initBalls:function(){for(var e=[],t=0;t<3;t++){e.push({show:0,start:{x:0,y:0},offset:{x:0,y:0},ani:0})}this.balls=e}}};t.default=i},7086:function(e,t,s){"use strict";s.d(t,"b",(function(){return i})),s.d(t,"c",(function(){return n})),s.d(t,"a",(function(){}));var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-uni-view",e._l(e.balls,(function(t,i){return s("v-uni-view",{key:i,staticClass:"flyball",style:{opacity:t.show,top:t.start.y+"px",left:t.start.x+"px",transitionDuration:(t.show?e.duration/1e3:0)+"s","transition-timing-function":e.xTimeFunction[t.ani?1:0],transform:"translate3d("+t.offset.x+"px,0,0)",zIndex:e.zIndex}},[s("v-uni-view",{staticClass:"wrap",style:{marginLeft:-e.size/2+"px",marginTop:-e.size/2+"px",padding:e.size+"px",backgroundImage:e.ballImage,backgroundColor:e.ballColor,transitionDuration:(t.show?e.duration/1e3:0)+"s",transform:"translate3d(0,"+t.offset.y+"px,0)","transition-timing-function":e.yTimeFunction[t.ani?0:1]}})],1)})),1)},n=[]},"799f":function(e,t,s){var i=s("c86c");t=i(!1),t.push([e.i,".goods-specs .scroller[data-v-1fd69570]{max-height:%?600?%;min-height:%?500?%}.goods-specs .info[data-v-1fd69570]{padding-left:%?170?%}.goods-specs .info .promote[data-v-1fd69570]{height:%?50?%;border-radius:%?30?%;background-color:#f50c04}.goods-specs .info uni-image[data-v-1fd69570]{width:%?160?%;height:%?160?%;display:block;background-color:#fff;margin-left:%?-164?%;border-radius:%?10?%}.goods-specs .item[data-v-1fd69570]{padding:%?6?% %?20?%;border:#f1f1f1 %?2?% solid;background-color:#f1f1f1;border-radius:%?8?%;text-align:center;color:#333;min-width:%?100?%}.goods-specs .item.selected[data-v-1fd69570]{border-color:var(--color-red);background-color:#fff8f8;color:var(--color-red)}.goods-specs .item.disabled[data-v-1fd69570]{border-color:#f1f1f1;background-color:#fff;color:#ddd}.goods-specs .item .destroy[data-v-1fd69570]{text-decoration:line-through}.goods-specs .quantity[data-v-1fd69570]{margin-top:%?40?%}.goods-specs .popup-quantity .plus[data-v-1fd69570]{border-radius:%?0?% %?8?% %?8?% 0;font-size:%?30?%}.goods-specs .popup-quantity .minus[data-v-1fd69570]{border-radius:%?8?% %?0?% %?0?% %?8?%;font-size:%?30?%}.goods-specs .popup-quantity .text[data-v-1fd69570],\n.goods-specs .popup-quantity .input[data-v-1fd69570]{display:block;background-color:#f1f1f1;overflow:hidden;height:%?66?%;line-height:%?66?%}.goods-specs .popup-quantity .input[data-v-1fd69570]{padding:%?0?% %?22?%;width:%?120?%;background-color:#eee;margin:0 %?2?%}",""]),e.exports=t},9566:function(e,t,s){"use strict";var i=s("e96d"),n=s.n(i);n.a},"973b":function(e,t,s){"use strict";s("6a54");var i=s("f5bd").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,s("64aa"),s("bf0f"),s("2797");var n=i(s("0ed1")),a=i(s("ac89")),o={name:"uniPopupDialog",props:{title:{type:String,default:"选择规格"},item:{type:Object/null,default:function(){return{}}},current:{type:Object/null,default:function(){return{}}},showQty:{type:Boolean,default:!0},prices:{type:Object,default:function(){return{}}}},data:function(){return{goods:{},quantity:1,selected:{},specs:{list:{},spec_name_1:"",spec_name_2:"",spec_1:{},spec_2:{},selected:{},disabled:{},destroy:{}},fields:{field:{name:"spec_name_1",value:"spec_1"},thefield:{name:"spec_name_2",value:"spec_2"}}}},inject:["popup"],created:function(){this.popup.mkclick=!0,this.goods=this.item,this.getSpecs()},methods:{confirm:function(){var e=this;return this.selected.spec_id?this.selected.stock<this.quantity?(uni.showToast({title:"库存不足",icon:"none"}),!1):(this.selected.quantity=this.quantity,void this.$emit("confirm",(function(){e.popup.close()}),this.selected)):(uni.showToast({title:"请选择规格",icon:"none"}),!1)},close:function(){var e=this;this.beforeClose?this.$emit("close",(function(){e.popup.close()})):this.popup.close()},changeQty:function(e,t){var s=0,i=Number(this.quantity)||1;"plus"==t?s=i+1:"minus"==t?i>1&&(s=i-1):(s=Number(e.detail.value),s<1&&(s=1)),!a.default.isEmpty(this.selected.spec_id)&&this.selected.stock<s&&(uni.showToast({title:"库存不足",icon:"none"}),s=this.selected.stock>0?this.selected.stock:1),s>0&&(this.quantity=s)},getSpecs:function(){var e=this;n.default.request("goods/specs",{goods_id:e.goods.goods_id},(function(t){if(0==t.code)if(e.specs[e.fields.field.value]=e.uniqueSpecs(t.data.list,e.fields.field.value),e.specs.list={},t.data.list.forEach((function(t,s){0==s&&(e.specs[e.fields.field.name]=t[e.fields.field.name],e.specs[e.fields.thefield.name]=t[e.fields.thefield.name],Object.assign(e.goods,t)),e.specs.list[t.spec_id]=t})),e.current.stock>0)e.changeSpec(e.current,e.fields.field.value,e.fields.thefield.value);else for(var s in e.specs.list){var i=e.specs.list[s];if(i.stock>0){e.changeSpec(i,e.fields.field.value,e.fields.thefield.value);break}}}))},changeSpec:function(e,t,s){if(this.specs.disabled[e[t]])return!1;if(this.specs.selected[t]=e[t],this.specs.selected[s]=e[s],this.secondColumn(this,t,s),this.specs.disabled={},this.specs.destroy={},e[s]){var i={};for(var n in this.specs.list){var o=this.specs.list[n];o[t]==e[t]&&(i[o[s]]=o)}for(var c in this.specs[s]){var l=this.specs[s][c];(!i[l[s]]||i[l[s]].stock<1)&&(this.specs.disabled[l[s]]=!0,this.specs.destroy[l[s]]=!i[l[s]],l[s]==this.specs.selected[s]&&delete this.specs.selected[s])}for(var d in this.selected={},this.specs.list){var u=this.specs.list[d];if(this.specs.selected[t]==u[t]&&this.specs.selected[s]==u[s]){this.selected=u;break}}}else{for(var r in this.specs[t]){var f=this.specs[t][r];0==f.stock&&(this.specs.disabled[f[t]]=!0)}this.selected=e}this.selected.specification="",this.selected.spec_name_1&&(this.selected.specification+=this.selected.spec_name_1+":"+this.selected.spec_1),this.selected.spec_name_2&&(this.selected.specification+=" "+this.selected.spec_name_2+":"+this.selected.spec_2),a.default.isEmpty(this.prices.specs)||a.default.isEmpty(this.prices.specs[this.selected.spec_id])||(a.default.isEmpty(this.selected.promotion),this.selected.promotion={name:this.prices.name,price:this.prices.specs[this.selected.spec_id].price}),Object.assign(this.goods,this.selected)},uniqueSpecs:function(e,t){var s={};for(var i in e){var n=e[i];a.default.isEmpty(s[n[t]])&&(s[n[t]]=n)}return s},secondColumn:function(e,t,s){var i=[];for(var n in e.specs.list){var a=e.specs.list[n];a[t]==e.specs.selected[t]&&(i[a[s]]=a)}Object.assign(e.specs[s],i)}}};t.default=o},a527:function(e,t,s){var i=s("c86c");t=i(!1),t.push([e.i,".flyball[data-v-155da67c]{position:fixed;-webkit-transform:translateZ(0);transform:translateZ(0);z-index:999;transition-property:-webkit-transform;transition-property:transform;transition-property:transform,-webkit-transform;pointer-events:none}.flyball .wrap[data-v-155da67c]{border-radius:100%}",""]),e.exports=t},a60e:function(e,t,s){"use strict";s.r(t);var i=s("7086"),n=s("1c25");for(var a in n)["default"].indexOf(a)<0&&function(e){s.d(t,e,(function(){return n[e]}))}(a);s("f334");var o=s("828b"),c=Object(o["a"])(n["default"],i["b"],i["c"],!1,null,"155da67c",null,!1,i["a"],void 0);t["default"]=c.exports},c3ba:function(e,t,s){var i=s("a527");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var n=s("967d").default;n("05608228",i,!0,{sourceMap:!1,shadowMode:!1})},d05a:function(e,t,s){"use strict";s.d(t,"b",(function(){return n})),s.d(t,"c",(function(){return a})),s.d(t,"a",(function(){return i}));var i={uniIcons:s("ea5d").default},n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-uni-view",[s("v-uni-view",{staticClass:"bgf top-round-edge pt5 goods-specs"},[s("uni-icons",{staticClass:"ml10 absolute",attrs:{type:"closeempty",size:"44"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.close.apply(void 0,arguments)}}}),e.title?s("v-uni-view",{staticClass:"uni-bold uni-center f-16 pt5 pb10"},[e._v(e._s(e.title))]):e._e(),s("v-uni-view",{staticClass:"uni-flex uni-row width-between info"},[s("v-uni-view",{staticClass:"uni-flex uni-row pd10"},[s("v-uni-view",{staticClass:"image"},[s("v-uni-image",{attrs:{src:e.goods.image||e.goods.default_image,mode:"scaleToFill"}})],1),s("v-uni-view",{staticClass:"uni-flex uni-column ml10"},[s("v-uni-view",{staticClass:"uni-flex uni-row"},[s("v-uni-text",{staticClass:"f-red f-17"},[e._v(e._s(e._f("currency")(e.goods.price)))]),e.goods.promotion?s("v-uni-text",{staticClass:"f-white pl10 pr10 ml10 promote"},[e._v(e._s(e.goods.promotion.name)+e._s(e._f("currency")(e.goods.promotion.price)))]):e._e()],1),s("v-uni-text",{staticClass:"f-gray f-13"},[e._v("销量："+e._s(e.goods.sales||0)+"件")]),s("v-uni-view",{staticClass:"mt5 f-13 l-h20"},[s("v-uni-text",[e._v("您已选择：")]),e.goods.spec_qty>0?s("v-uni-text",[e._v(e._s(e.specs.selected[e.fields.field.value]||""))]):e._e(),e.goods.spec_qty>0?s("v-uni-text",{staticClass:"ml5"},[e._v(e._s(e.specs.selected[e.fields.thefield.value]||""))]):e._e(),0==e.goods.spec_qty?s("v-uni-text",[e._v("默认规格")]):e._e()],1)],1)],1)],1),s("v-uni-scroll-view",{staticClass:"scroller",attrs:{"scroll-x":!1,"scroll-y":!0}},[s("v-uni-view",{staticClass:"pd10"},[e.specs[e.fields.field.name]?s("v-uni-view",{staticClass:"uni-flex uni-column"},[s("v-uni-text",{staticClass:"mr10 uni-bold f-15 f-c55"},[e._v(e._s(e.specs[e.fields.field.name]))]),s("v-uni-view",{staticClass:"uni-flex uni-row flex-wrap"},e._l(Object.values(e.specs[e.fields.field.value]),(function(t,i){return s("v-uni-view",{key:i,class:["bgf mr10 mt10 item",e.specs.disabled[t[e.fields.field.value]]?"disabled":"",e.specs.selected[e.fields.field.value]==t[e.fields.field.value]?"selected":""],on:{click:function(s){arguments[0]=s=e.$handleEvent(s),e.changeSpec(t,e.fields.field.value,e.fields.thefield.value)}}},[s("v-uni-text",{class:["pl10 pr10",e.specs.destroy[t[e.fields.field.value]]?"destroy":""]},[e._v(e._s(t[e.fields.field.value]))])],1)})),1)],1):e._e(),e.specs[e.fields.thefield.name]?s("v-uni-view",{staticClass:"uni-flex uni-column mt10 pt10"},[s("v-uni-text",{staticClass:"mr10 uni-bold f-15 f-c55"},[e._v(e._s(e.specs[e.fields.thefield.name]))]),s("v-uni-view",{staticClass:"uni-flex uni-row flex-wrap"},e._l(Object.values(e.specs[e.fields.thefield.value]),(function(t,i){return s("v-uni-view",{key:i,class:["bgf mr10 mt10 item",e.specs.disabled[t[e.fields.thefield.value]]?"disabled":"",e.specs.selected[e.fields.thefield.value]==t[e.fields.thefield.value]?"selected":""],on:{click:function(s){arguments[0]=s=e.$handleEvent(s),e.changeSpec(t,e.fields.thefield.value,e.fields.field.value)}}},[s("v-uni-text",{class:["pl10 pr10",e.specs.destroy[t[e.fields.thefield.value]]?"destroy":""]},[e._v(e._s(t[e.fields.thefield.value]))])],1)})),1)],1):e._e(),s("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:e.showQty,expression:"showQty"}],staticClass:"uni-flex uni-row width-between mt10 mb10 pt10 mr10 pr10 quantity"},[s("v-uni-view",{staticClass:"mt5 uni-flex uni-row"},[s("v-uni-text",{staticClass:"uni-bold f-15 f-c55"},[e._v("购买数量")]),e.selected.spec_id?s("v-uni-text",{staticClass:"f-gray ml10"},[e._v("库存"+e._s(e.selected.stock||e.goods.stock)+"件")]):e._e()],1),s("v-uni-view",{staticClass:"uni-flex uni-row popup-quantity"},[s("v-uni-text",{staticClass:"minus uni-center flex-middle text",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.changeQty(t,"minus")}}},[e._v("-")]),s("v-uni-input",{staticClass:"uni-center f-13 flex-middle input",attrs:{maxlength:"3",type:"number"},on:{blur:function(t){arguments[0]=t=e.$handleEvent(t),e.changeQty.apply(void 0,arguments)}},model:{value:e.quantity,callback:function(t){e.quantity=t},expression:"quantity"}}),s("v-uni-text",{staticClass:"plus uni-center flex-middle text",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.changeQty(t,"plus")}}},[e._v("+")])],1)],1)],1)],1),s("v-uni-view",{staticClass:"pd10"},[s("v-uni-view",{staticClass:"uni-center f-white uni-bold f-15 mybutton",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.confirm.apply(void 0,arguments)}}},[e._v("确定")])],1)],1)],1)},a=[]},dc40:function(e,t,s){"use strict";s.r(t);var i=s("973b"),n=s.n(i);for(var a in i)["default"].indexOf(a)<0&&function(e){s.d(t,e,(function(){return i[e]}))}(a);t["default"]=n.a},e403:function(e,t,s){"use strict";s.r(t);var i=s("d05a"),n=s("dc40");for(var a in n)["default"].indexOf(a)<0&&function(e){s.d(t,e,(function(){return n[e]}))}(a);s("9566");var o=s("828b"),c=Object(o["a"])(n["default"],i["b"],i["c"],!1,null,"1fd69570",null,!1,i["a"],void 0);t["default"]=c.exports},e96d:function(e,t,s){var i=s("799f");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);var n=s("967d").default;n("5044eacb",i,!0,{sourceMap:!1,shadowMode:!1})},f334:function(e,t,s){"use strict";var i=s("c3ba"),n=s.n(i);n.a}}]);