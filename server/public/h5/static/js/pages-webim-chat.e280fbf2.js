(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-webim-chat"],{"0473":function(t,e,a){"use strict";a.r(e);var i=a("8004"),n=a.n(i);for(var o in i)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(o);e["default"]=n.a},"0e17":function(t,e,a){"use strict";var i=a("f5bd").default,n=i(a("2634")),o=i(a("2fdc")),r=i(a("0ed1"));i(a("62a0"));function s(){return s=(0,o.default)((0,n.default)().mark((function t(e){return(0,n.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:uni.chooseImage({count:1,sizeType:["compressed"],success:function(t){r.default.upload("upload/file",t.tempFilePaths[0],{folder:"webim/"},(function(t){if(0==t.code){var a='<img width="100" src="'+t.data.fileUrl+'" />';r.default.request("webim/send",{content:a,toid:e.form.toid,store_id:e.form.store_id},(function(t){}))}}))},fail:function(t){uni.showModal({content:t.errMsg,showCancel:!1})}});case 1:case"end":return t.stop()}}),t)}))),s.apply(this,arguments)}t.exports={store:
/**
 * @link https://www.shopwind.net/
 * @copyright Copyright (c) 2018 ShopWind Inc Inc. All Rights Reserved.
 *
 * This is not free software. Do not use it for commercial purposes. 
 * If you need commercial operation, please contact us to purchase a license.
 * @license https://www.shopwind.net/license/
 *
 * @Id chat.js 2022.5.22 $
 * @author winder
 */
function(t){r.default.request("store/read",{store_id:t.form.toid},(function(t){0==t.code&&t.data&&uni.setNavigationBarTitle({title:t.data.store_name})}))},user:function(t){r.default.request("user/read",{userid:t.form.toid},(function(t){0==t.code&&t.data&&uni.setNavigationBarTitle({title:t.data.nickname||t.data.username})}))},goods:function(t){r.default.request("goods/read",{goods_id:t.form.goodsid},(function(e){0==e.code&&(t.goods=e.data||{})}))},submit:function(t){r.default.request("webim/send",t.form,(function(e){0==e.code?t.form.content="":e.message&&uni.showToast({icon:"none",title:e.message})}))},upload:function(t){return s.apply(this,arguments)},gallery:function(t,e){r.default.request("webim/logs",Object.assign(t.form,{page_size:200}),(function(e){if(0==e.code&&e.data.pagination.total>t.gallery.length){var a=t.gallery.length>0?t.gallery[t.gallery.length-1].id:0;t.gallery=e.data.list,t.gallery[t.gallery.length-1].id>a&&t.$nextTick((function(){uni.pageScrollTo({scrollTop:99999,duration:50})}))}}),e)}}},"12d4":function(t,e,a){"use strict";var i=a("f323"),n=a.n(i);n.a},"1a48":function(t,e,a){var i=a("73d0");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=a("967d").default;n("cb730118",i,!0,{sourceMap:!1,shadowMode:!1})},"1f9c":function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return i}));var i={uParse:a("8882").default,myFooter:a("cfe7").default,uniIcons:a("ea5d").default},n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",[a("v-uni-view",{staticClass:"scroller"},t._l(t.gallery,(function(e,i){return a("v-uni-view",{key:i,staticClass:"uni-flex uni-column pd10 mt10"},[e.fromid==t.visitor.userid?a("v-uni-view",{staticClass:"uni-flex uni-row mb10 flex-end"},[a("v-uni-view",{staticClass:"mr10",staticStyle:{"text-align":"right"}},[a("v-uni-view",[a("v-uni-text",{staticClass:"f-gray f-12"},[t._v(t._s(e.created))])],1),e.content?a("u-parse",{staticClass:"round-edge pd10 f-white inline-block richtext",attrs:{content:e.content}}):t._e()],1),a("v-uni-view",{staticClass:"portrait mt10"},[a("v-uni-image",{attrs:{src:e.from.portrait}})],1)],1):a("v-uni-view",{staticClass:"uni-flex uni-row mb10"},[a("v-uni-view",{staticClass:"portrait mt10"},[a("v-uni-image",{attrs:{src:e.from.portrait}})],1),a("v-uni-view",{staticClass:"ml10"},[a("v-uni-view",{staticClass:"flex-middle"},[a("v-uni-text",[t._v(t._s(e.from.nickname||e.from.username))]),a("v-uni-text",{staticClass:"ml10 f-gray f-12"},[t._v(t._s(e.created))])],1),e.content?a("u-parse",{staticClass:"round-edge pd10 bgf inline-block richtext",attrs:{content:e.content}}):t._e()],1)],1)],1)})),1),a("my-footer",[t.goods.goods_id?a("v-uni-view",{staticClass:" goods ml10 mr10 pd10 mt10 bgf round-edge"},[a("v-uni-view",{staticClass:"uni-flex width-between f-12 mb5"},[a("v-uni-text",{staticClass:"f-gray"},[t._v("正在咨询")]),a("v-uni-text",{staticClass:"f-red",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.autosend.apply(void 0,arguments)}}},[t._v("发送商品")])],1),a("v-uni-view",{staticClass:"uni-flex"},[a("v-uni-image",{staticClass:"image round-edge",attrs:{src:t.goods.default_image}}),a("v-uni-view",{staticClass:"ml10"},[a("v-uni-view",{staticClass:"line-clamp-2 l-h20"},[t._v(t._s(t.goods.goods_name))]),a("v-uni-view",{staticClass:"f-red"},[t._v(t._s(t._f("currency")(t.goods.price)))])],1)],1)],1):t._e(),a("v-uni-view",{staticClass:"uni-flex uni-row width-between flex-middle send"},[a("v-uni-textarea",{staticClass:"bgf textarea round-edge width-surplus ml5 mr5 f-14",attrs:{"cursor-spacing":"50","placeholder-class":"placeholder","auto-height":!0},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}}),t.form.content?a("v-uni-button",{staticClass:"mybutton ml10 mr10 pl10 pr10 f-white f-14",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.submit.apply(void 0,arguments)}}},[t._v("发送")]):a("uni-icons",{staticClass:"upload",attrs:{type:"plus-filled",size:"76",color:"#ababab"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.upload.apply(void 0,arguments)}}})],1)],1)],1)},o=[]},"1ff7":function(t,e,a){"use strict";a("6a54");var i=a("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("5c47");i(a("0ed1"));var n={name:"MyFooter",props:{bgcolor:{type:String,default:"var(--color-basic)"},fixed:{type:Boolean,default:!0}},data:function(){return{height:0}},mounted:function(){var t=this,e=uni.createSelectorQuery().in(this);e.select(".wraper").boundingClientRect((function(e){t.height=e?Math.floor(e.height):0})).exec()}};e.default=n},"2f8d":function(t,e,a){var i=a("c86c");e=i(!1),e.push([t.i,".footer[data-v-fb052a5a]{height:var(--height)}.footer .wraper[data-v-fb052a5a]{background-color:var(--bgcolor);\n\t/* 适配iphoneX的底部*/padding-bottom:constant(safe-area-inset-bottom);\n\t/*兼容 IOS>11.2*/padding-bottom:env(safe-area-inset-bottom)}",""]),t.exports=e},"35b4":function(t,e,a){"use strict";a.r(e);var i=a("1f9c"),n=a("0473");for(var o in n)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(o);a("6edd");var r=a("828b"),s=Object(r["a"])(n["default"],i["b"],i["c"],!1,null,"c00630e8",null,!1,i["a"],void 0);e["default"]=s.exports},"6edd":function(t,e,a){"use strict";var i=a("1a48"),n=a.n(i);n.a},"73d0":function(t,e,a){var i=a("c86c");e=i(!1),e.push([t.i,".scroller[data-v-c00630e8]{padding-bottom:%?250?%}.mybutton[data-v-c00630e8]{padding-top:%?0?%;padding-bottom:%?0?%;border-radius:%?20?%}.portrait[data-v-c00630e8],\n.portrait uni-image[data-v-c00630e8]{border-radius:100%;width:%?100?%;height:%?100?%}.send[data-v-c00630e8]{padding:%?30?% %?10?%}.send .textarea[data-v-c00630e8]{padding:%?20?% %?40?%}.send .round-edge[data-v-c00630e8],\n.send .mybutton[data-v-c00630e8]{border-radius:%?40?%}.goods[data-v-c00630e8]{background-color:#fffaf9}.goods .image[data-v-c00630e8]{width:%?100?%;height:%?100?%}.upload[data-v-c00630e8]{line-height:1}[data-v-c00630e8] .richtext{background-color:#5af;text-align:left}[data-v-c00630e8] .richtext uni-view{line-height:%?40?%;word-break:break-all}[data-v-c00630e8] .wxParse .chatbox .img,[data-v-c00630e8] .wxParse .chatbox img{width:%?100?%!important;height:%?100?%!important}[data-v-c00630e8] .wxParse.bgf{background-color:#fff}[data-v-c00630e8] uni-button::after{border:0}[data-v-c00630e8] .footer .pdx{border-top:%?2?% #dedede solid}",""]),t.exports=e},8004:function(t,e,a){"use strict";a("6a54");var i=a("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i(a("ac89")),o=i(a("0e17")),r=i(a("5f12")),s={data:function(){return{visitor:{},form:{},goods:{},gallery:[],timer:null}},methods:{submit:function(){o.default.submit(this)},upload:function(){o.default.upload(this)},autosend:function(){this.form.content='<div class="uni-flex chatbox"><img width="50" height="50" src="'+this.goods.default_image+'" class="round-edge" /><div class="ml10"><div>'+this.goods.goods_name+"</div><div>"+(0,r.default)(this.goods.price)+"</div></div></div>",o.default.submit(this)}},onLoad:function(t){this.form=t,this.visitor=uni.getStorageSync("visitor")||{},n.default.verifyLogin(!0,n.default.getUrl())&&(o.default.gallery(this,!0),this.form.store_id>0?o.default.store(this):o.default.user(this),this.form.goodsid>0&&o.default.goods(this))},onShow:function(){var t=this;this.timer=setInterval((function(){o.default.gallery(t,!1)}),2e3)},onHide:function(){this.timer&&clearInterval(this.timer)},onUnload:function(){this.timer&&clearInterval(this.timer)}};e.default=s},8370:function(t,e,a){"use strict";a.r(e);var i=a("1ff7"),n=a.n(i);for(var o in i)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return i[t]}))}(o);e["default"]=n.a},b5ac:function(t,e,a){"use strict";a.d(e,"b",(function(){return i})),a.d(e,"c",(function(){return n})),a.d(e,"a",(function(){}));var i=function(){var t=this.$createElement,e=this._self._c||t;return e("v-uni-view",{staticClass:"footer",style:{"--bgcolor":this.bgcolor||"none","--height":this.height+"px"}},[e("v-uni-view",{class:["wraper",this.fixed?"fixed-bottom":""]},[this._t("default")],2)],1)},n=[]},cfe7:function(t,e,a){"use strict";a.r(e);var i=a("b5ac"),n=a("8370");for(var o in n)["default"].indexOf(o)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(o);a("12d4");var r=a("828b"),s=Object(r["a"])(n["default"],i["b"],i["c"],!1,null,"fb052a5a",null,!1,i["a"],void 0);e["default"]=s.exports},f323:function(t,e,a){var i=a("2f8d");i.__esModule&&(i=i.default),"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=a("967d").default;n("e74e04f6",i,!0,{sourceMap:!1,shadowMode:!1})}}]);