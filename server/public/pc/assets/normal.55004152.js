import{_ as te}from"./cart_empty.ba3c6efa.js";import{r as ne,y as O,d as le,e as f,f as oe,o as r,c as p,a as e,g as s,i as o,w as ae,k as n,F as L,m as E,l as x,h as U,p as q,t as d,a1 as ce,j as v,C as y,v as ie,x as re,I as de,n as M,U as S}from"./index.193ff21d.js";import{q as _e,r as pe}from"./order.54656e97.js";import{c as ue}from"./address.7c7c91a8.js";import{j as fe}from"./delivery.b69a1721.js";import{_ as me}from"./home.5fee7488.js";import{_ as he}from"./home.85f29f3b.js";import{a as ge}from"./blocks.a7684095.js";import"./chat.b31cc7ff.js";const m=I=>(ie("data-v-e97f4266"),I=I(),re(),I),ye={class:"main bgf"},ve={class:"w",style:{"padding-top":"20px"}},be={style:{"min-height":"100px"}},xe={key:0},ke={key:0,class:"addresses mt20"},we={class:"f-16 bold f-yahei mb10 flex-middle"},Le=m(()=>s("span",{class:"ml5"},"\u6536\u8D27\u5730\u5740",-1)),Ie={class:"uni-flex uni-row flex-wrap"},Ve=["onClick"],Ce={class:"f-13 f-c55 mt5"},je=m(()=>s("p",null,"\u4F7F\u7528\u65B0\u5730\u5740",-1)),Oe={class:"cartbox mt20 f-13"},Ee={class:"hd mb20"},Fe=m(()=>s("span",{class:"ml20"},"\u5E97\u94FA\u5546\u54C1",-1)),ze=v("\u4EF7\u683C"),Be=v("\u6570\u91CF"),Ue=v("\u5C0F\u8BA1"),Se={key:0,class:"bd"},De={class:"list mb10"},Ne=m(()=>s("label",null,"\u5E97\u94FA\uFF1A",-1)),Pe={class:"f-blue"},$e={class:"item"},qe=["src"],Me={class:"desc mr10 pt5 pb5 f-14"},Ae={key:0,class:"f-gray f-12 mt5"},Te={class:"uni-flex uni-row pd10 flex-middle mt10"},Ke=m(()=>s("span",null,"\u4E70\u5BB6\u7559\u8A00\uFF1A",-1)),Ge={key:0,class:"uni-flex uni-row flex-middle each"},He=m(()=>s("p",{class:"pt10 pb10"},[s("label",{class:"mr10 f-c55"},"\u914D\u9001\u8D39\u7528\uFF1A")],-1)),Je={class:"center pd10 f-gray"},Qe={class:"f-red f-14"},Re={key:1,class:"uni-flex uni-row flex-middle each"},We={class:"pt10 pb10"},Xe=m(()=>s("label",{class:"mr10 f-c55"},"\u5546\u5BB6\u4F18\u60E0\uFF1A",-1)),Ye={class:"center f-red f-14"},Ze={key:2,class:"uni-flex uni-row flex-middle each"},es={class:"pt10 pb10"},ss=m(()=>s("label",{class:"mr10 f-c55"},"\u6EE1\u51CF\u4F18\u60E0\uFF1A",-1)),ts={class:"center f-red f-14"},ns={class:"uni-flex uni-row flex-middle each"},ls=m(()=>s("p",{class:"pt10 pb10"},[s("label",{class:"f-red"},"\u5E97\u94FA\u5408\u8BA1\uFF1A")],-1)),os={class:"center f-red f-14"},as={class:"pd10 ml10"},cs=m(()=>s("label",{class:"mr10"},"\u79EF\u5206\u62B5\u6263\uFF1A",-1)),is={class:"pd10 f-red"},rs={key:1,class:"bd pd10 center"},ds={class:"fd"},_s=m(()=>s("span",null,"\u8FD4\u56DE\u8D2D\u7269\u8F66",-1)),ps=m(()=>s("label",null,"\u603B\u4EF7\uFF1A",-1)),us={class:"mr20 f-17 f-red"},fs=v("\u53BB\u7ED3\u7B97"),ms={key:0,class:"empty uni-flex uni-row flex-middle flex-center"},hs=m(()=>s("p",{class:"pd10"},[s("img",{src:te,width:"83"})],-1)),gs={class:"ml20"},ys=m(()=>s("p",{class:"bold mb20"},"\u60A8\u672A\u9009\u62E9\u7ED3\u7B97\u5546\u54C1",-1)),vs=v("\u8FD4\u56DE\u8D2D\u7269\u8F66"),bs=m(()=>s("span",{class:"f-simsun"},">>",-1)),xs={setup(I){const V=ne(!0),c=O({gtype:[]}),C=O([]),h=O({points:0,money:0,useIntegral:!1}),a=O({otype:"normal",region_id:0,consignee:"",phone_mob:"",delivery:{type:"express",list:{}},postscript:{},coupon_sn:{},exchange_integral:0,anonymous:{}});le(()=>{_e(a,l=>{if(Object.assign(c,l.list),Object.values(c.orderList).forEach(t=>{a.delivery.list[t.store_id]=""}),K(),N(),A(),c.gtype.length>1)return de.alert("\u5B9E\u7269\u5546\u54C1\u548C\u865A\u62DF\u5546\u54C1\u56E0\u7ED3\u7B97\u5468\u671F\u4E0D\u540C\uFF0C\u4E0D\u652F\u6301\u4E00\u8D77\u7ED3\u7B97\uFF0C\u8BF7\u91CD\u65B0\u9009\u62E9\u7ED3\u7B97\u5546\u54C1","\u63D0\u793A",{confirmButtonText:"OK",callback:function(t,g){M("cart/index")}})},V)});function A(){ue({page_size:50},l=>{if(Object.assign(C,l.list||[]),C.length>0){let t=C[0];Object.assign(a,t),D()}})}function D(){let l=[];Object.values(c.orderList).forEach(t=>{l.push({type:a.delivery.type,store_id:t.store_id,weight:t.weight,amount:t.amount,phone_mob:a.phone_mob,region_id:a.region_id,latitude:a.latitude,longitude:a.longitude,address:a.province+a.city+a.district+a.address,consignee:a.consignee})}),fe(l,t=>{a.delivery.list=t||{},F()},V)}function T(l){Object.assign(a,l),D()}function N(){if(c.integralExchange){let l=c.integralExchange,t=l.maxPoints>l.userIntegral?l.userIntegral:l.maxPoints;h.points=t,h.money=l.rate*t,h.useIntegral=!0,a.exchange_integral=t}}function K(){Object.keys(c.orderList).forEach(l=>{let t=c.orderList[l].coupons;S(t)||(a.coupon_sn[l]=t[0].coupon_sn)})}function G(l){N(),F()}function P(l){let t=c.orderList[l].coupons;for(let g in t)if(t[g].coupon_sn==a.coupon_sn[l])return parseFloat(t[g].money);return 0}function H(l){a.exchange_integral=l?parseFloat(h.points):0,F()}function F(){let l=0;if(Object.keys(c.orderList).forEach(t=>{let g=a.delivery.list[t].freight||0,z=S(c.orderList[t].fullprefer)?0:parseFloat(c.orderList[t].fullprefer.price),B=S(c.orderList[t].coupons)?0:P(t);c.orderList[t].paymoney=parseFloat(c.orderList[t].amount)+g-z-B,l+=c.orderList[t].paymoney}),a.exchange_integral>0){let t=l-h.money;t<0&&(h.money=l,a.exchange_integral=l/c.integralExchange.rate,t=0),l=t}c.paymoney=l}function J(){pe(a,l=>{M("/cashier/trade/pay/"+l.bizIdentity.toLowerCase()+"/"+l.bizOrderId)})}return(l,t)=>{const g=f("el-step"),z=f("el-steps"),B=f("LocationInformation"),j=f("el-icon"),Q=f("Select"),R=f("Plus"),w=f("router-link"),u=f("el-col"),k=f("el-row"),W=f("el-input"),$=f("el-option"),X=f("el-select"),Y=f("el-switch"),Z=f("DArrowLeft"),ee=f("el-button"),se=oe("loading");return r(),p(L,null,[e(me,{exclude:["category"]}),s("div",ye,[s("div",ve,[e(z,{active:1,"finish-status":"success","process-status":"process",simple:""},{default:o(()=>[e(g,{title:"\u9009\u62E9\u5546\u54C1\u7ED3\u7B97"}),e(g,{title:"\u786E\u8BA4\u8BA2\u5355\u4FE1\u606F"}),e(g,{title:"\u4ED8\u6B3E"}),e(g,{title:"\u786E\u8BA4\u6536\u8D27"}),e(g,{title:"\u8BC4\u4EF7"})]),_:1}),ae((r(),p("div",be,[Object.values(n(c)).length>0?(r(),p("div",xe,[n(c).gtype.includes("material")?(r(),p("div",ke,[s("div",we,[e(j,null,{default:o(()=>[e(B)]),_:1}),Le]),s("div",Ie,[(r(!0),p(L,null,E(n(C),i=>(r(),p("div",{onClick:b=>T(i),class:q(["item pointer pd10 mr10 mb10 relative",i.addr_id==n(a).addr_id?"selected":""])},[s("p",null,d(i.consignee)+" "+d(i.phone_mob||i.phone_tel),1),s("p",Ce,d(i.province)+" "+d(i.city||"")+" "+d(i.district||"")+" "+d(i.address),1),i.addr_id==n(a).addr_id?(r(),U(j,{key:0,class:"ico absolute"},{default:o(()=>[e(Q)]),_:1})):x("",!0)],10,Ve))),256)),e(w,{to:"/my/address/list?redirect="+n(ce)(),class:"item rlink pointer pd10 mr10 mb10 center"},{default:o(()=>[e(j,{size:20},{default:o(()=>[e(R)]),_:1}),je]),_:1},8,["to"])])])):x("",!0),s("div",Oe,[s("div",Ee,[e(k,null,{default:o(()=>[e(u,{span:12},{default:o(()=>[Fe]),_:1}),e(u,{span:4,class:"center"},{default:o(()=>[ze]),_:1}),e(u,{span:4,class:"center"},{default:o(()=>[Be]),_:1}),e(u,{span:4,class:"center"},{default:o(()=>[Ue]),_:1})]),_:1})]),n(c).orderList?(r(),p("div",Se,[(r(!0),p(L,null,E(n(c).orderList,(i,b)=>(r(),p("div",De,[e(k,{class:"pt10 pb10"},{default:o(()=>[e(u,{span:24,class:"uni-flex uni-row flex-middle"},{default:o(()=>[Ne,s("span",Pe,d(i.store_name),1)]),_:2},1024)]),_:2},1024),(r(!0),p(L,null,E(i.items,_=>(r(),p("div",$e,[e(k,{class:"flex-middle"},{default:o(()=>[e(u,{span:12,class:"uni-flex uni-row flex-middle"},{default:o(()=>[e(w,{to:"/goods/detail/"+_.goods_id,class:"pic ml10 mr10 pt10 pb10"},{default:o(()=>[s("img",{width:"70",height:"70",src:_.goods_image},null,8,qe)]),_:2},1032,["to"]),s("div",Me,[e(w,{to:"/goods/detail/"+_.goods_id,class:"rlink"},{default:o(()=>[v(d(_.goods_name),1)]),_:2},1032,["to"]),_.specification?(r(),p("p",Ae,d(_.specification),1)):x("",!0)])]),_:2},1024),e(u,{span:4,class:"center f-red"},{default:o(()=>[v(d(n(y)(_.price)),1)]),_:2},1024),e(u,{span:4,class:"center"},{default:o(()=>[v(d(_.quantity),1)]),_:2},1024),e(u,{span:4,class:"center f-red f-14"},{default:o(()=>[v(d(n(y)(_.subtotal)),1)]),_:2},1024)]),_:2},1024)]))),256)),e(k,{class:"extra"},{default:o(()=>[e(u,{span:14},{default:o(()=>[s("div",Te,[Ke,e(W,{modelValue:n(a).postscript[b],"onUpdate:modelValue":_=>n(a).postscript[b]=_,class:"postscript",placeholder:"\u5BF9\u5546\u54C1\u7684\u7279\u6B8A\u9700\u6C42\uFF0C\u5982\u989C\u8272\u3001\u5C3A\u7801\u7B49",clearable:""},null,8,["modelValue","onUpdate:modelValue"])])]),_:2},1024),e(u,{span:10,class:"cost pt10 pb10"},{default:o(()=>[n(a).delivery.list[b].name?(r(),p("div",Ge,[He,s("p",Je,[s("span",Qe,"+"+d(n(a).delivery.list[b].freight|n(y)),1)])])):x("",!0),i.coupons&&i.coupons.length>0?(r(),p("div",Re,[s("p",We,[Xe,e(X,{modelValue:n(a).coupon_sn[b],"onUpdate:modelValue":_=>n(a).coupon_sn[b]=_,onChange:_=>G()},{default:o(()=>[e($,{value:"0",label:"\u4E0D\u4F7F\u7528\u4F18\u60E0\u5238"}),(r(!0),p(L,null,E(i.coupons,_=>(r(),U($,{value:_.coupon_sn,label:_.name+" : "+n(y)(_.money)},null,8,["value","label"]))),256))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),s("p",Ye," -"+d(n(y)(P(b))),1)])):x("",!0),i.fullprefer.price>0?(r(),p("div",Ze,[s("p",es,[ss,s("span",null,"\u8D2D\u6EE1"+d(n(y)(i.fullprefer.amount))+"\u5143\uFF0C\u51CF"+d(n(y)(i.fullprefer.price))+"\u5143",1)]),s("p",ts," -"+d(n(y)(i.fullprefer.price)),1)])):x("",!0),s("div",ns,[ls,s("p",os,d(n(y)(n(c).orderList[b].paymoney)),1)])]),_:2},1024)]),_:2},1024)]))),256)),n(h).points>0?(r(),U(k,{key:0},{default:o(()=>[e(u,{span:14}),e(u,{span:6},{default:o(()=>[s("p",as,[cs,s("span",{class:q([n(h).useIntegral?"":"f-gray"])},[e(Y,{modelValue:n(h).useIntegral,"onUpdate:modelValue":t[0]||(t[0]=i=>n(h).useIntegral=i),onChange:H,class:"mr10"},null,8,["modelValue"]),v(" \u53EF\u4F7F\u7528"+d(n(h).points)+"\u79EF\u5206\u62B5\u6263 ",1)],2)])]),_:1}),e(u,{span:4,class:"center f-14"},{default:o(()=>[s("p",is," - "+d(n(y)(n(h).useIntegral?n(h).money:0)),1)]),_:1})]),_:1})):x("",!0)])):(r(),p("div",rs,"\u6682\u65E0\u53EF\u7ED3\u7B97\u7684\u5546\u54C1")),s("div",ds,[e(k,{class:"pt10 pb10 mt10"},{default:o(()=>[e(u,{span:5,class:"uni-flex uni-row flex-middle"},{default:o(()=>[e(w,{to:"/cart/index",class:"rlink ml20 vertical-middle f-green"},{default:o(()=>[e(j,{size:12},{default:o(()=>[e(Z)]),_:1}),_s]),_:1})]),_:1}),e(u,{span:19,class:"vertical-middle flex-end f-15"},{default:o(()=>[ps,s("span",us,d(n(y)(n(c).paymoney)),1),e(ee,{onClick:J,type:"primary",size:"large",class:"mr10"},{default:o(()=>[fs]),_:1})]),_:1})]),_:1})])])])):x("",!0)])),[[se,V.value]]),!V.value&&Object.values(n(c)).length==0?(r(),p("div",ms,[hs,s("div",gs,[ys,e(w,{to:"/cart/index",class:"rlink f-blue f-13 f-yahei"},{default:o(()=>[vs,bs]),_:1})])])):x("",!0)])]),e(he)],64)}}};var Fs=ge(xs,[["__scopeId","data-v-e97f4266"]]);export{Fs as default};
