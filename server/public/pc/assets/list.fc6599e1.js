import{r as _,y as K,d as q,A as P,O as T,e as n,o as w,h as $,i as l,g as b,a as e,k as i,l as N,j as m,E as A,B as G,u as H,f as J,c as R,F as Q,n as W,w as X,t as E,I as Y}from"./index.193ff21d.js";import{a as Z,b as ee,c as te,d as le}from"./address.7c7c91a8.js";import{m as ae}from"./my.f8f02874.js";import{_ as oe}from"./user.4d579c29.js";import{m as se}from"./my.91c6acd7.js";import{a as ne,s as ie}from"./blocks.a7684095.js";import{m as de}from"./multiselector.e3a63f5d.js";import"./weixin.864acb91.js";import"./chat.b31cc7ff.js";const re={class:"map"},ce={class:"mb20"},ue=m("\u5173\u95ED"),pe=m("\u63D0\u4EA4"),_e={props:{title:{type:String,default:""},visible:{type:Boolean,default:!1},data:{type:[Object,Array],default:()=>({})}},emits:["close"],setup(F,{emit:v}){const k=F,{proxy:p}=G(),u=_(!1),h=_(!1),t=K({}),y=K({lat:39.908802,lng:116.397502}),C=_();q(()=>{ie(null,a=>{C.value=a.mapKey})}),P(()=>k.visible,a=>{u.value=a}),P(()=>k.data,a=>{Object.assign(t,a,{defaddr:parseInt(a.defaddr)}),a.latitude&&a.longitude&&(Object.assign(y,{lat:parseFloat(a.latitude),lng:parseFloat(a.longitude)}),c.value=[{id:"center",position:y}])});const B=()=>{t.addr_id?Z(t,a=>{A.success("\u7F16\u8F91\u6210\u529F"),v("close",a,"update")},h):ee(t,a=>{A.success("\u6DFB\u52A0\u6210\u529F"),v("close",a)},h)},V=()=>{v("close",null)},U=a=>{t.region_id=a.id},s=_({pan:a=>{c.value=[{id:"center",position:p.$refs.map.getCenter()}]},panend:a=>{let d=p.$refs.map.getCenter();t.latitude=d.lat,t.longitude=d.lng}}),c=_([{id:"center",position:y,styleId:"marker",content:""}]),f=T({marker:{}});return(a,d)=>{const g=n("el-input"),r=n("el-form-item"),I=n("tmap-multi-marker"),S=n("tmap-map"),j=n("el-switch"),O=n("el-form"),z=n("el-button"),D=n("el-dialog");return w(),$(D,{modelValue:u.value,"onUpdate:modelValue":d[4]||(d[4]=o=>u.value=o),title:F.title,width:850,center:!0,draggable:!0,"destroy-on-close":!0,"close-on-click-modal":!1,"before-close":V},{footer:l(()=>[b("div",ce,[e(z,{onClick:V},{default:l(()=>[ue]),_:1}),e(z,{type:"primary",onClick:B,loading:h.value},{default:l(()=>[pe]),_:1},8,["loading"])])]),default:l(()=>[e(O,{inline:!0},{default:l(()=>[e(r,{label:"\u6536\u8D27\u4EBA","label-width":85},{default:l(()=>[e(g,{modelValue:i(t).consignee,"onUpdate:modelValue":d[0]||(d[0]=o=>i(t).consignee=o)},null,8,["modelValue"])]),_:1}),e(r,{label:"\u6240\u5728\u5730\u533A","label-width":85,class:"uni-flex uni-row w-full"},{default:l(()=>[e(de,{api:"region/list",idField:"region_id",nameField:"name",parentField:"parent_id",original:[i(t).province,i(t).city,i(t).district],onCallback:U},null,8,["original"])]),_:1}),e(r,{label:"\u8BE6\u7EC6\u5730\u5740","label-width":85,style:{"margin-right":"40%"}},{default:l(()=>[e(g,{modelValue:i(t).address,"onUpdate:modelValue":d[1]||(d[1]=o=>i(t).address=o),placeholder:"\u8857\u9053/\u5C0F\u533A/\u697C\u680B/\u623F\u53F7"},null,8,["modelValue"])]),_:1}),C.value?(w(),$(r,{key:0,label:"\u4F4D\u7F6E\u5750\u6807","label-width":85},{default:l(()=>[b("div",re,[e(S,{mapKey:C.value,zoom:"15",center:i(y),events:s.value,scrollable:!1,ref:"map"},{default:l(()=>[e(I,{geometries:c.value,styles:i(f),ref:"markers"},null,8,["geometries","styles"])]),_:1},8,["mapKey","center","events"])])]),_:1})):N("",!0),e(r,{label:"\u624B\u673A\u53F7\u7801","label-width":85},{default:l(()=>[e(g,{modelValue:i(t).phone_mob,"onUpdate:modelValue":d[2]||(d[2]=o=>i(t).phone_mob=o)},null,8,["modelValue"])]),_:1}),e(r,{label:"\u8BBE\u4E3A\u9ED8\u8BA4","label-width":85,class:"w-full"},{default:l(()=>[e(j,{modelValue:i(t).defaddr,"onUpdate:modelValue":d[3]||(d[3]=o=>i(t).defaddr=o),"active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","title"])}}};var me=ne(_e,[["__scopeId","data-v-047cd1f4"]]);const fe={class:"main w pt10"},ge={class:"round-edge pd10 bgf"},be={class:"pd10"},ve=m("\u7269\u6D41"),he=m("\u6536\u8D27\u5730\u5740"),ye={class:"round-edge pl20 pr20 pt20 pb20 bgf mt20"},we={class:"mb20"},ke=m("\u6DFB\u52A0\u65B0\u5730\u5740"),Ce=m("\u7F16\u8F91 "),Ve=m("\u5220\u9664 "),xe={key:0,class:"mt20 mb20"},De={setup(F){const v=H(),k=_(!1),p=_([]),u=_({}),h=_(0),t=K({visible:!1});q(()=>{x()});const y=()=>{t.title="\u6DFB\u52A0\u6536\u8D27\u5730\u5740",t.visible=!0,t.data={}},C=s=>{t.title="\u7F16\u8F91\u6536\u8D27\u5730\u5740",t.visible=!0,t.data=p.value[s],h.value=s},B=s=>{Y.confirm("\u60A8\u786E\u5B9A\u8981\u5220\u9664\u8BE5\u6761\u8BB0\u5F55\u5417\uFF1F","\u63D0\u793A",{confirmButtonText:"\u786E\u5B9A",type:"warning"}).then(()=>{le(p.value[s],c=>{A.success("\u5220\u9664\u6210\u529F\uFF01"),p.value.splice(s,1)})}).catch(()=>{})},V=(s,c)=>{var f;t.visible=!1,s&&s.consignee&&(c=="update"?Object.assign((f=p.value[h.value])!=null?f:{},s):p.value.unshift(s),v.query.redirect&&W(v.query.redirect))},U=s=>{x({page_size:s})},M=s=>{x({page:s,page_size:u.value.page_size})};function x(s){te(s,c=>{p.value=c.list,u.value=c.pagination},k)}return(s,c)=>{const f=n("el-col"),a=n("el-breadcrumb-item"),d=n("el-breadcrumb"),g=n("el-button"),r=n("el-table-column"),I=n("SuccessFilled"),S=n("el-icon"),j=n("el-table"),O=n("el-pagination"),z=n("el-row"),D=J("loading");return w(),R(Q,null,[e(ae),b("div",fe,[e(z,{gutter:12},{default:l(()=>[e(f,{span:4},{default:l(()=>[e(se)]),_:1}),e(f,{span:20},{default:l(()=>[b("div",ge,[b("div",be,[e(d,{separator:"/"},{default:l(()=>[e(a,null,{default:l(()=>[ve]),_:1}),e(a,null,{default:l(()=>[he]),_:1})]),_:1})])]),b("div",ye,[b("div",we,[e(g,{type:"primary",onClick:y},{default:l(()=>[ke]),_:1})]),X((w(),$(j,{data:p.value,size:"large",border:!1,stripe:!1,class:"f-13","header-cell-style":{background:"#f3f8fe"}},{default:l(()=>[e(r,{type:"selection"}),e(r,{width:"60",label:"\u9ED8\u8BA4"},{default:l(o=>[o.row.defaddr==1?(w(),$(S,{key:0,class:"f-green f-14"},{default:l(()=>[e(I)]),_:1})):N("",!0)]),_:1}),e(r,{prop:"consignee",width:"100",label:"\u6536\u8D27\u4EBA\u59D3\u540D"}),e(r,{label:"\u6240\u5728\u5730\u533A",width:"250"},{default:l(o=>[m(E(o.row.province)+E(o.row.city)+E(o.row.district||""),1)]),_:1}),e(r,{prop:"address",label:"\u8BE6\u7EC6\u5730\u5740",width:"240"}),e(r,{prop:"phone_mob",label:"\u624B\u673A\u53F7",width:"150",sortable:""}),e(r,{prop:"phone_tel",label:"\u56FA\u5B9A\u7535\u8BDD",width:"150",sortable:""}),e(r,{fixed:"right",label:"\u64CD\u4F5C",width:"120",align:"center"},{default:l(o=>[e(g,{class:"f-13 mr5",type:"text",onClick:L=>C(o.$index)},{default:l(()=>[Ce]),_:2},1032,["onClick"]),e(g,{class:"f-13",type:"text",onClick:L=>B(o.$index)},{default:l(()=>[Ve]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[D,k.value]]),u.value.total>0?(w(),R("div",xe,[e(O,{currentPage:u.value.page,"onUpdate:currentPage":c[0]||(c[0]=o=>u.value.page=o),"page-size":u.value.page_size,"onUpdate:page-size":c[1]||(c[1]=o=>u.value.page_size=o),"page-sizes":[10,50,100,200],background:!1,layout:"total, sizes, prev, pager, next",total:u.value.total,onSizeChange:U,onCurrentChange:M,"hide-on-single-page":!1,class:"center"},null,8,["currentPage","page-size","total"])])):N("",!0)])]),_:1})]),_:1})]),e(me,{title:i(t).title,visible:i(t).visible,data:i(t).data,onClose:V},null,8,["title","visible","data"]),e(oe)],64)}}};export{De as default};
